# Описание задания

## Формулировка задания

В этом задании вам предстоит собрать **единый пайплайн предварительной обработки данных** о выполнении авиарейсов из набора **U.S. Airline On-Time Performance**.  
Пайплайн должен принимать на вход «сырую» таблицу и возвращать готовую к обучению матрицу признаков.  

Все операции по преобразованию данных должны выполняться **только внутри пайплайна** (например, с использованием `ColumnTransformer`, `Pipeline` и стандартных трансформеров `sklearn`).  
Никакие действия по очистке или преобразованию признаков вне пайплайна не допускаются.

### Предлагаемая последовательность шагов в пайплайне

1. **Автоматическое определение типов признаков.**  
   Разделите колонки на три группы: числовые, категориальные и временные.  
   К числовым можно отнести задержки, длительности, расстояние и индикаторы (0/1).  
   К категориальным — коды авиакомпаний, аэропортов, города и т. п.  
   К временным — дату (`FlightDate`) и планируемое/фактическое время (`CRSDepTime`, `CRSArrTime`, `DepTime`, `ArrTime`).

2. **Обработка числовых признаков.**  
   Выполните заполнение пропусков (например, `SimpleImputer`) и масштабирование (`StandardScaler`).

3. **Обработка категориальных признаков.**  
   Заполните пропуски наиболее частым значением и выполните кодирование (`OneHotEncoder(handle_unknown="ignore")`).

4. **Обработка временных признаков.**  
   С помощью простого `FunctionTransformer` внутри пайплайна выделите из временных столбцов полезные компоненты:  
   - из `FlightDate` — год, месяц, день недели;  
   - из времени `CRSDepTime`, `CRSArrTime`, `DepTime`, `ArrTime` — час вылета и час прибытия (в форматах `hhmm` → `час`).  
   Преобразования должны выполняться автоматически при вызове пайплайна, без внешних действий.

5. **Обработка пропусков и нестандартных значений.**  
   В наборе встречаются пропуски (например, у отменённых рейсов отсутствуют фактическое время прибытия).  
   Такие случаи должны корректно обрабатываться средствами пайплайна.  
   Не используйте `dropna` и ручную фильтрацию вне пайплайна.

6. **Сборка итогового `ColumnTransformer`.**  
   Убедитесь, что `pipeline.fit_transform(X_train)` и `pipeline.transform(X_test)` выполняются без ошибок на реальных данных с пропусками и редкими категориями.

> На этом этапе мы не обучаем модель. Целевой признак можно выбрать произвольно (например, `ArrDelay` для регрессии или индикатор `ArrDelayMinutes >= 15` для классификации) — он используется только для разделения данных на обучающую и тестовую выборки и не должен попадать в пайплайн.

---

## Описание датасета

Для выполнения работы используется открытый набор **U.S. Airline On-Time Performance**, публикуемый Бюро транспортной статистики США (BTS). 
Каждая строка описывает отдельный рейс и содержит сведения о его расписании, выполнении и задержках.

### Дата и время  
- `FlightDate` — календарная дата рейса;  
- `Year`, `Month`, `DayOfMonth`, `DayOfWeek` — те же компоненты даты отдельными полями;  
- `CRSDepTime`, `CRSArrTime` — **планируемое** время вылета и прибытия (в формате `hhmm`, например 1325 = 13:25);  
- `DepTime`, `ArrTime` — **фактическое** время вылета и прибытия.

### Данные об авиакомпании  
- `Marketing_Airline_Network`, `Operating_Airline` — коды авиакомпаний, выполняющих и продающих рейс;  
- **IATA-код** — двухбуквенный международный код авиакомпании (например, AA — American Airlines, DL — Delta);  
- **DOT ID** — числовой идентификатор перевозчика, присвоенный Министерством транспорта США и остающийся стабильным при переименованиях компаний.

### Аэропорты отправления и назначения  
- `Origin`, `Dest` — IATA-коды аэропортов;  
- `OriginAirportID`, `DestAirportID` и другие числовые поля — стабильные идентификаторы и дополнительные сведения (город, штат).  
Для данного задания эти колонки можно рассматривать как категориальные.

### Время полёта и расстояние  
- `DepDelay`, `ArrDelay` — отклонения от расписания (в минутах, отрицательные значения означают вылет или прибытие раньше плана);  
- `TaxiOut`, `TaxiIn` — время руления до и после полёта;  
- `AirTime` — продолжительность полёта в минутах;  
- `CRSElapsedTime`, `ActualElapsedTime` — планируемое и фактическое время в пути;  
- `Distance` — расстояние между аэропортами (в авиамилях).

### События и причины задержек  
- `Cancelled` (0/1) — факт отмены рейса;  
- `CancellationCode` — код причины отмены;  
- `Diverted` (0/1) — факт выполнения рейса не в пункт назначения;  
- `CarrierDelay`, `WeatherDelay`, `NASDelay`, `SecurityDelay`, `LateAircraftDelay` — продолжительность задержек по различным причинам (в минутах).

---

## Критерии оценивания

### Обязательные условия
- Работа оформлена в блокноте `solution.ipynb`;  
- Имеются пояснения и заголовки, отсутствуют нерелевантные ячейки и нерешенные ошибки;  
- Все преобразования выполняются **внутри пайплайна** (`Pipeline`, `ColumnTransformer`, `FunctionTransformer` и др.);
- Нет подозрений в незадекларированном использовании LLM.


### Начисление баллов
1. **Разделение признаков по типам и сборка пайплайна** — 2 балл.  
2. **Обработка числовых признаков** (импутация + масштабирование) — 2 балл.  
3. **Обработка категориальных признаков** (импутация + кодирование) — 2 балл.  
4. **Обработка временных признаков** (парсинг времени `hhmm`, извлечение даты и часа) — 2 балл.  
5. **Корректная работа с пропусками и аномалиями** (без ошибок, без внешних `dropna`) — 2 балл.

### Снятие баллов
- за предобработку вне пайплайна (независимо от количества нарушений).  
- за частично некорректную, неполную или неправильную реализацию любого из пунктов 1–5.
